# Admin Scaffold - åå°ç®¡ç†è„šæ‰‹æ¶

åŸºäº Phoenix Framework çš„åå°ç®¡ç†ç³»ç»Ÿè„šæ‰‹æ¶ï¼ŒåŒ…å«ç”¨æˆ·è®¤è¯ã€æƒé™ç®¡ç†ã€èœå•ç®¡ç†ã€å®¡è®¡æ—¥å¿—ç­‰åŠŸèƒ½ã€‚

## æŠ€æœ¯æ ˆ

- **Phoenix**: 1.8.3
- **Elixir**: ~> 1.15
- **PostgreSQL**: æ•°æ®åº“
- **Phoenix LiveView**: å®æ—¶äº¤äº’ UI
- **Swoosh**: é‚®ä»¶å‘é€
- **Bandit**: Web æœåŠ¡å™¨

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–å¹¶è®¾ç½®æ•°æ®åº“

```bash
mix setup
```

æˆ–è€…åˆ†æ­¥æ‰§è¡Œï¼š

```bash
mix deps.get
mix ecto.create
mix ecto.migrate
```

### 2. å¯åŠ¨æœåŠ¡å™¨

```bash
mix phx.server
```

æˆ–è€…åœ¨ IEx ä¸­å¯åŠ¨ï¼š

```bash
iex -S mix phx.server
```

æœåŠ¡å™¨å°†åœ¨ http://localhost:4000 å¯åŠ¨

### 3. é¦–æ¬¡ä½¿ç”¨

1. è®¿é—® http://localhost:4000/users/register æ³¨å†Œè´¦æˆ·
2. è¾“å…¥é‚®ç®±å’Œå¯†ç å®Œæˆæ³¨å†Œ
3. æ³¨å†Œåè‡ªåŠ¨ç™»å½•ï¼Œè¿›å…¥ä»ªè¡¨æ¿

## ä¸»è¦åŠŸèƒ½

### ğŸ¯ ä»ªè¡¨æ¿ (`/dashboard`)

ç™»å½•åçš„ä¸»é¡µé¢ï¼Œæ˜¾ç¤ºï¼š
- ğŸ“Š ç”¨æˆ·æ€»æ•°ç»Ÿè®¡
- ğŸ‘¥ è§’è‰²æ€»æ•°ç»Ÿè®¡
- ğŸ” æƒé™æ€»æ•°ç»Ÿè®¡
- âš¡ ä»Šæ—¥æ“ä½œæ•°ç»Ÿè®¡
- ğŸ“ˆ æœ€è¿‘7å¤©æ“ä½œè¶‹åŠ¿å›¾è¡¨
- ğŸ”— å¿«é€Ÿæ“ä½œé“¾æ¥

### ğŸ‘¤ ç”¨æˆ·ç®¡ç† (`/admin/users`)

ç®¡ç†ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·ï¼š
- **æœç´¢åŠŸèƒ½**: æŒ‰é‚®ç®±æˆ– ID æœç´¢
- **ç­›é€‰åŠŸèƒ½**: æŒ‰çŠ¶æ€ã€è§’è‰²ç­›é€‰
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤ã€æ‰¹é‡å¯ç”¨/ç¦ç”¨
- **CRUD**: åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ç”¨æˆ·
- **æƒé™æ§åˆ¶**: åŸºäºæƒé™çš„æŒ‰é’®æ˜¾ç¤º

### ğŸ­ è§’è‰²ç®¡ç† (`/admin/roles`)

ç®¡ç†ç”¨æˆ·è§’è‰²ï¼š
- **æœç´¢åŠŸèƒ½**: æŒ‰åç§°æˆ–æè¿°æœç´¢
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤
- **å¡ç‰‡è§†å›¾**: ç›´è§‚çš„è§’è‰²å±•ç¤º
- **æƒé™åˆ†é…**: ä¸ºè§’è‰²åˆ†é…æƒé™å’Œèœå•

### ğŸ” æƒé™ç®¡ç† (`/admin/permissions`)

ç®¡ç†ç³»ç»Ÿæƒé™ï¼š
- **æœç´¢åŠŸèƒ½**: æŒ‰åç§°ã€æ ‡è¯†æˆ–æè¿°æœç´¢
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤
- **ç½‘æ ¼å¸ƒå±€**: ç´§å‡‘çš„æƒé™å±•ç¤º
- **æƒé™æ ‡è¯†**: ç”¨äºæƒé™æ£€æŸ¥çš„å”¯ä¸€æ ‡è¯†ç¬¦

### ğŸ“‹ èœå•ç®¡ç† (`/admin/menus`)

ç®¡ç†ç³»ç»Ÿèœå•ï¼š
- **æ ‘å½¢ç»“æ„**: æ”¯æŒçˆ¶å­èœå•å…³ç³»
- **æ’åºåŠŸèƒ½**: è‡ªå®šä¹‰èœå•æ˜¾ç¤ºé¡ºåº
- **çŠ¶æ€æ§åˆ¶**: å¯ç”¨/ç¦ç”¨èœå•é¡¹
- **å›¾æ ‡æ”¯æŒ**: è‡ªå®šä¹‰èœå•å›¾æ ‡
- **æ‰¹é‡æ“ä½œ**: æ‰¹é‡åˆ é™¤ã€æ‰¹é‡å¯ç”¨/ç¦ç”¨
- **æœç´¢åŠŸèƒ½**: æŒ‰åç§°æˆ–è·¯å¾„æœç´¢

### ğŸ” å®¡è®¡æ—¥å¿— (`/admin/audit-logs`)

æŸ¥çœ‹ç³»ç»Ÿæ“ä½œè®°å½•ï¼š
- **æœç´¢åŠŸèƒ½**: æŒ‰æ“ä½œã€èµ„æºã€ç”¨æˆ·æœç´¢
- **ç­›é€‰åŠŸèƒ½**: æŒ‰èµ„æºç±»å‹ã€æ“ä½œç±»å‹ç­›é€‰
- **è¯¦ç»†ä¿¡æ¯**: ç”¨æˆ·ã€æ“ä½œã€èµ„æºã€IP åœ°å€ã€User Agent
- **è‡ªåŠ¨è®°å½•**: ç³»ç»Ÿè‡ªåŠ¨è®°å½•æ‰€æœ‰å…³é”®æ“ä½œ

### âš™ï¸ ç³»ç»Ÿè®¾ç½® (`/admin/settings`)

ç®¡ç†å…¨å±€é…ç½®ï¼š
- **ç½‘ç«™ä¿¡æ¯**: ç³»ç»Ÿåç§°ã€æè¿°
- **æ³¨å†Œè®¾ç½®**: å…è®¸/ç¦æ­¢æ–°ç”¨æˆ·æ³¨å†Œã€æ˜¯å¦éœ€è¦é‚®ç®±éªŒè¯
- **é‚®ä»¶é…ç½®**: SMTP æœåŠ¡å™¨è®¾ç½®
- **ç»´æŠ¤æ¨¡å¼**: å¯ç”¨/ç¦ç”¨ç»´æŠ¤æ¨¡å¼ã€åªå…è®¸ç®¡ç†å‘˜è®¿é—®

## æƒé™ç³»ç»Ÿ

### æƒé™çº§åˆ«

1. **è·¯ç”±çº§æƒé™**: é€šè¿‡ `RoutePermission` æ’ä»¶è‡ªåŠ¨æ£€æŸ¥
2. **æŒ‰é’®çº§æƒé™**: ä½¿ç”¨ `PermissionButton` ç»„ä»¶æ§åˆ¶æŒ‰é’®æ˜¾ç¤º
3. **æ•°æ®æƒé™**: å¯æ‰©å±•çš„æ•°æ®èŒƒå›´æƒé™

### æƒé™æ ‡è¯†

- `users.view` - æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨
- `users.edit` - ç¼–è¾‘ç”¨æˆ·
- `users.delete` - åˆ é™¤ç”¨æˆ·
- `roles.view` - æŸ¥çœ‹è§’è‰²åˆ—è¡¨
- `roles.edit` - ç¼–è¾‘è§’è‰²
- `roles.delete` - åˆ é™¤è§’è‰²
- `permissions.view` - æŸ¥çœ‹æƒé™åˆ—è¡¨
- `permissions.edit` - ç¼–è¾‘æƒé™
- `permissions.delete` - åˆ é™¤æƒé™
- `menus.view` - æŸ¥çœ‹èœå•åˆ—è¡¨
- `menus.edit` - ç¼–è¾‘èœå•
- `menus.delete` - åˆ é™¤èœå•
- `settings.view` - æŸ¥çœ‹ç³»ç»Ÿè®¾ç½®
- `settings.edit` - ç¼–è¾‘ç³»ç»Ÿè®¾ç½®
- `audit_logs.view` - æŸ¥çœ‹å®¡è®¡æ—¥å¿—

## é¡¹ç›®ç»“æ„

```
admin_scaffold/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ admin_scaffold/
â”‚   â”‚   â”œâ”€â”€ accounts/          # ç”¨æˆ·è´¦æˆ·ä¸Šä¸‹æ–‡
â”‚   â”‚   â”‚   â”œâ”€â”€ user.ex        # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ user_token.ex  # ç”¨æˆ·ä»¤ç‰Œ
â”‚   â”‚   â”‚   â”œâ”€â”€ user_notifier.ex # ç”¨æˆ·é€šçŸ¥
â”‚   â”‚   â”‚   â”œâ”€â”€ role.ex       # è§’è‰²æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ permission.ex # æƒé™æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ menu.ex       # èœå•æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ accounts.ex        # è´¦æˆ·ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ system.ex         # ç³»ç»ŸåŠŸèƒ½ï¼ˆå®¡è®¡æ—¥å¿—ã€è®¾ç½®ï¼‰
â”‚   â”‚   â””â”€â”€ repo.ex          # æ•°æ®åº“ä»“åº“
â”‚   â””â”€â”€ admin_scaffold_web/
â”‚       â”œâ”€â”€ live/
â”‚       â”‚   â”œâ”€â”€ dashboard_live/
â”‚       â”‚   â”‚   â””â”€â”€ index.ex   # ä»ªè¡¨æ¿é¡µé¢
â”‚       â”‚   â”œâ”€â”€ user_live/
â”‚       â”‚   â”‚   â”œâ”€â”€ index.ex   # ç”¨æˆ·åˆ—è¡¨ï¼ˆå«æœç´¢ã€ç­›é€‰ã€æ‰¹é‡æ“ä½œï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ show.ex    # ç”¨æˆ·è¯¦æƒ…
â”‚       â”‚   â”‚   â”œâ”€â”€ login.ex   # ç™»å½•é¡µé¢
â”‚       â”‚   â”‚   â”œâ”€â”€ registration.ex # æ³¨å†Œé¡µé¢
â”‚       â”‚   â”‚   â””â”€â”€ settings.ex # è®¾ç½®é¡µé¢
â”‚       â”‚   â”œâ”€â”€ role_live/
â”‚       â”‚   â”‚   â””â”€â”€ index.ex   # è§’è‰²åˆ—è¡¨ï¼ˆå«æœç´¢ã€æ‰¹é‡æ“ä½œï¼‰
â”‚       â”‚   â”œâ”€â”€ permission_live/
â”‚       â”‚   â”‚   â””â”€â”€ index.ex   # æƒé™åˆ—è¡¨ï¼ˆå«æœç´¢ã€æ‰¹é‡æ“ä½œï¼‰
â”‚       â”‚   â”œâ”€â”€ menu_live/
â”‚       â”‚   â”‚   â””â”€â”€ index.ex   # èœå•åˆ—è¡¨ï¼ˆå«æœç´¢ã€æ‰¹é‡æ“ä½œï¼‰
â”‚       â”‚   â”œâ”€â”€ audit_log_live/
â”‚       â”‚   â”‚   â””â”€â”€ index.ex   # å®¡è®¡æ—¥å¿—ï¼ˆå«æœç´¢ã€ç­›é€‰ï¼‰
â”‚       â”‚   â””â”€â”€ setting_live/
â”‚       â”‚       â””â”€â”€ index.ex   # ç³»ç»Ÿè®¾ç½®
â”‚       â”œâ”€â”€ components/
â”‚       â”‚   â””â”€â”€ permission_button.ex # æƒé™æŒ‰é’®ç»„ä»¶
â”‚       â”œâ”€â”€ plugs/
â”‚       â”‚   â””â”€â”€ route_permission.ex  # è·¯ç”±æƒé™éªŒè¯æ’ä»¶
â”‚       â”œâ”€â”€ controllers/
â”‚       â”‚   â””â”€â”€ user_session_controller.ex # ä¼šè¯æ§åˆ¶å™¨
â”‚       â”œâ”€â”€ authorization.ex     # æƒé™æ£€æŸ¥è¾…åŠ©å‡½æ•°
â”‚       â””â”€â”€ router.ex          # è·¯ç”±é…ç½®
â”œâ”€â”€ priv/
â”‚   â””â”€â”€ repo/
â”‚       â””â”€â”€ migrations/        # æ•°æ®åº“è¿ç§»
â””â”€â”€ mix.exs                # é¡¹ç›®é…ç½®
```

## è·¯ç”±è¯´æ˜

### å…¬å¼€è·¯ç”±ï¼ˆæ— éœ€ç™»å½•ï¼‰

- `GET /` - é¦–é¡µ
- `GET /users/register` - ç”¨æˆ·æ³¨å†Œé¡µé¢
- `GET /users/log-in` - ç”¨æˆ·ç™»å½•é¡µé¢
- `POST /users/log-in` - å¤„ç†ç™»å½•è¯·æ±‚

### éœ€è¦è®¤è¯çš„è·¯ç”±

- `GET /dashboard` - ç®¡ç†ä»ªè¡¨æ¿
- `GET /admin/users` - ç”¨æˆ·åˆ—è¡¨
- `GET /admin/users/:id` - ç”¨æˆ·è¯¦æƒ…
- `GET /admin/users/:id/edit` - ç¼–è¾‘ç”¨æˆ·
- `GET /admin/roles` - è§’è‰²åˆ—è¡¨
- `GET /admin/roles/new` - æ–°å¢è§’è‰²
- `GET /admin/roles/:id/edit` - ç¼–è¾‘è§’è‰²
- `GET /admin/permissions` - æƒé™åˆ—è¡¨
- `GET /admin/permissions/new` - æ–°å¢æƒé™
- `GET /admin/permissions/:id/edit` - ç¼–è¾‘æƒé™
- `GET /admin/menus` - èœå•åˆ—è¡¨
- `GET /admin/menus/new` - æ–°å¢èœå•
- `GET /admin/menus/:id/edit` - ç¼–è¾‘èœå•
- `GET /admin/settings` - ç³»ç»Ÿè®¾ç½®
- `GET /admin/audit-logs` - å®¡è®¡æ—¥å¿—
- `GET /users/settings` - ä¸ªäººè®¾ç½®
- `DELETE /users/log-out` - ç™»å‡º

## å¼€å‘å‘½ä»¤

```bash
# è¿è¡Œæµ‹è¯•
mix test

# æ ¼å¼åŒ–ä»£ç 
mix format

# é‡ç½®æ•°æ®åº“
mix ecto.reset

# ç”Ÿæˆæ–°çš„è¿ç§»
mix ecto.gen.migration migration_name

# è¿è¡Œè¿ç§»
mix ecto.migrate

# å›æ»šè¿ç§»
mix ecto.rollback
```

## æ•°æ®åº“

é¡¹ç›®ä½¿ç”¨ PostgreSQL æ•°æ®åº“ï¼ŒåŒ…å«ä»¥ä¸‹è¡¨ï¼š

- `users` - ç”¨æˆ·è¡¨
- `users_tokens` - ç”¨æˆ·ä»¤ç‰Œè¡¨ï¼ˆç”¨äºä¼šè¯å’Œé‚®ç®±ç¡®è®¤ï¼‰
- `roles` - è§’è‰²è¡¨
- `permissions` - æƒé™è¡¨
- `menus` - èœå•è¡¨
- `user_roles` - ç”¨æˆ·-è§’è‰²å…³è”è¡¨
- `role_permissions` - è§’è‰²-æƒé™å…³è”è¡¨
- `role_menus` - è§’è‰²-èœå•å…³è”è¡¨
- `settings` - ç³»ç»Ÿè®¾ç½®è¡¨
- `audit_logs` - å®¡è®¡æ—¥å¿—è¡¨

## è®¾è®¡ç³»ç»Ÿ

### Neo-Brutalist Dark é£æ ¼

- ç‹¬ç‰¹å­—ä½“ç»„åˆ (Syne + Manrope + JetBrains Mono)
- éœ“è™¹è‰²å½©æ–¹æ¡ˆ (é’/ç²‰/é»„/ç´«/æ©™)
- åŠ¨ç”»æ•ˆæœ (æ·¡å…¥ã€æ‚¬åœã€è„‰å†²ã€æ•…éšœæ–‡å­—)
- å“åº”å¼å¸ƒå±€ (ç§»åŠ¨ç«¯ + æ¡Œé¢ç«¯)

## æ³¨æ„äº‹é¡¹

1. **é‚®ä»¶åŠŸèƒ½**: å½“å‰ Swoosh é…ç½®äº†ä½†æœªè®¾ç½®å®é™…çš„é‚®ä»¶å‘é€å™¨ï¼Œé‚®ç®±ç¡®è®¤åŠŸèƒ½éœ€è¦é…ç½®é‚®ä»¶æœåŠ¡
2. **ç”Ÿäº§ç¯å¢ƒ**: éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå‰ï¼Œè¯·å‚è€ƒ [Phoenix éƒ¨ç½²æŒ‡å—](https://hexdocs.pm/phoenix/deployment.html)
3. **å®‰å…¨æ€§**: ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è®¾ç½®å¼ºå¯†ç å’Œå®‰å…¨çš„ secret_key_base
4. **æƒé™**: é»˜è®¤åˆ›å»ºçš„è§’è‰²ä¼šæ‹¥æœ‰éƒ¨åˆ†æƒé™ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´

## Phase 1 æ–°å¢åŠŸèƒ½

âœ… **ç³»ç»Ÿè®¾ç½®æ¨¡å—** - ç½‘ç«™ä¿¡æ¯ã€æ³¨å†Œè®¾ç½®ã€é‚®ä»¶é…ç½®ã€ç»´æŠ¤æ¨¡å¼
âœ… **æœç´¢å’Œç­›é€‰** - ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€èœå•ã€å®¡è®¡æ—¥å¿—éƒ½æ”¯æŒæœç´¢å’Œç­›é€‰
âœ… **æ‰¹é‡æ“ä½œ** - ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€èœå•æ”¯æŒæ‰¹é‡åˆ é™¤å’Œæ‰¹é‡çŠ¶æ€æ›´æ–°
âœ… **æƒé™éªŒè¯å¢å¼º** - è·¯ç”±çº§æƒé™éªŒè¯ã€æŒ‰é’®çº§æƒé™æ§åˆ¶

## äº†è§£æ›´å¤š

* Phoenix å®˜ç½‘: https://www.phoenixframework.org/
* Phoenix æŒ‡å—: https://hexdocs.pm/phoenix/overview.html
* Phoenix æ–‡æ¡£: https://hexdocs.pm/phoenix
* Elixir è®ºå›: https://elixirforum.com/c/phoenix-forum
* Phoenix æºç : https://github.com/phoenixframework/phoenix

## è®¸å¯è¯

MIT
