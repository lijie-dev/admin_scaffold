# STORY-004: 添加审计日志系统

## 用户故事
作为系统管理员
我想要记录所有关键操作的审计日志
以便追踪系统变更和排查问题

## 背景
当前系统缺少审计日志功能：
- 用户的增删改操作没有记录
- 角色和权限的变更没有追踪
- 无法知道谁在什么时候做了什么操作

## 任务
- [ ] 完善 AuditLog schema（已存在但未使用）
- [ ] 创建审计日志记录函数
- [ ] 在关键操作中添加审计日志
- [ ] 创建审计日志查看页面
- [ ] 添加日志过滤和搜索功能

## 验收标准
- [ ] 所有 CRUD 操作都被记录
- [ ] 日志包含操作者、时间、操作类型、变更内容
- [ ] 管理员可以查看和搜索审计日志
- [ ] 日志记录不影响主要操作的性能

## 技术说明
使用 Ecto.Multi 确保操作和日志记录的原子性：
```elixir
Multi.new()
|> Multi.update(:user, changeset)
|> Multi.insert(:audit_log, audit_changeset)
|> Repo.transaction()
```

## 依赖关系
无

## 完成定义
- [ ] 所有任务已完成
- [ ] 测试通过
- [ ] 文档已更新
